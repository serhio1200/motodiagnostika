<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ—Ç–æ–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ PRO - –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥–±–æ—Ä –º–æ—Ç–æ—Ü–∏–∫–ª–æ–≤</title>
    
    <!-- PWA –º–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="–ú–æ—Ç–æ–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ PRO">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#6366F1">
    <meta name="description" content="–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∏ –ø–æ–¥–±–æ—Ä –º–æ—Ç–æ—Ü–∏–∫–ª–æ–≤">
    
    <link rel="apple-touch-icon" href="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgdmlld0JveD0iMCAwIDE5MiAxOTIiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIxOTIiIGhlaWdodD0iMTkyIiByeD0iMjQiIGZpbGw9IiM2MzY2RjEiLz4KPHN2ZyB4PSI0OCIgeT0iNDgiIHdpZHRoPSI5NiIgaGVpZ2h0PSI5NiIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJ3aGl0ZSI+CjxwYXRoIGQ9Ik0xMiAxMk0xMiA2TDEyIDE4TTYgMTJIMThaIiBzdHJva2U9IndoaXRlIiBzdHJva2Utd2lkdGg9IjIiLz4KPC9zdmc+Cjwvc3ZnPgo=">
    
    <style>
        :root {
            --primary-color: #6366F1;
            --primary-dark: #4F46E5;
            --secondary-color: #10B981;
            --danger-color: #EF4444;
            --warning-color: #F59E0B;
            --success-color: #10B981;
            --text-color: #1F2937;
            --text-light: #6B7280;
            --bg-color: #F9FAFB;
            --card-bg: #ffffff;
            --border-color: #E5E7EB;
            --shadow: 0 4px 20px rgba(0,0,0,0.08);
            --shadow-hover: 0 8px 30px rgba(0,0,0,0.12);
        }

        [data-theme="dark"] {
            --primary-color: #818CF8;
            --primary-dark: #6366F1;
            --secondary-color: #34D399;
            --danger-color: #F87171;
            --warning-color: #FBBF24;
            --success-color: #34D399;
            --text-color: #F9FAFB;
            --text-light: #D1D5DB;
            --bg-color: #111827;
            --card-bg: #1F2937;
            --border-color: #374151;
            --shadow: 0 4px 20px rgba(0,0,0,0.25);
            --shadow-hover: 0 8px 30px rgba(0,0,0,0.35);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Inter', 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            min-height: 100vh;
            padding: 0;
            margin: 0;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .app-container {
            max-width: 100%;
            margin: 0 auto;
            background: var(--bg-color);
            min-height: 100vh;
        }

        .app-header {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            padding: 24px 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }

        .app-header h1 {
            font-size: 1.6rem;
            margin-bottom: 6px;
            font-weight: 700;
            letter-spacing: -0.025em;
        }

        .app-header p {
            opacity: 0.9;
            font-size: 0.95rem;
            font-weight: 400;
        }

        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è */
        .nav-tabs {
            display: flex;
            background: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            position: sticky;
            top: 0;
            z-index: 99;
            padding: 0 8px;
            overflow-x: auto;
        }

        .nav-tab {
            flex: 1;
            min-width: 70px;
            background: none;
            border: none;
            padding: 16px 8px;
            text-align: center;
            font-weight: 600;
            font-size: 0.75rem;
            color: var(--text-light);
            cursor: pointer;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
            border-radius: 8px 8px 0 0;
            margin: 0 2px;
            white-space: nowrap;
        }

        .nav-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
            background: rgba(99, 102, 241, 0.05);
        }

        .nav-tab:active {
            background: rgba(99, 102, 241, 0.1);
            transform: scale(0.98);
        }

        /* –ö–æ–Ω—Ç–µ–Ω—Ç –≤–∫–ª–∞–¥–æ–∫ */
        .tab-content {
            display: none;
            padding: 24px 20px;
            animation: fadeIn 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* –ö–∞—Ä—Ç–æ—á–∫–∏ */
        .card {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 24px;
            margin-bottom: 24px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-hover);
        }

        .card:active {
            transform: scale(0.995);
        }

        .section-title {
            font-size: 1.2rem;
            font-weight: 700;
            margin-bottom: 20px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
            letter-spacing: -0.025em;
        }

        /* –§–æ—Ä–º—ã */
        .form-group {
            margin-bottom: 24px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
            color: var(--text-color);
            font-size: 0.95rem;
        }

        input, select, textarea {
            width: 100%;
            padding: 16px;
            border: 2px solid var(--border-color);
            border-radius: 14px;
            font-size: 16px;
            background: var(--card-bg);
            color: var(--text-color);
            transition: all 0.3s ease;
            font-family: inherit;
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary-color);
            outline: none;
            box-shadow: 0 0 0 4px rgba(99, 102, 241, 0.1);
            transform: translateY(-2px);
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .btn {
            background: linear-gradient(135deg, var(--primary-color), var(--primary-dark));
            color: white;
            border: none;
            border-radius: 14px;
            padding: 18px 24px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            display: block;
            width: 100%;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary-color), #059669);
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #D97706);
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color), #DC2626);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #059669);
        }

        /* –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ */
        .progress-container {
            margin: 24px 0;
        }

        .progress-bar {
            height: 10px;
            background: var(--border-color);
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 12px;
            box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.7s cubic-bezier(0.34, 1.56, 0.64, 1);
            border-radius: 5px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .progress-text {
            text-align: center;
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 500;
        }

        /* –°–æ–æ–±—â–µ–Ω–∏—è */
        .alert {
            padding: 18px;
            border-radius: 14px;
            margin: 20px 0;
            font-weight: 500;
            animation: slideIn 0.4s ease;
            border-left: 4px solid;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }

        .alert-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
            border-left-color: var(--success-color);
        }

        .alert-info {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary-color);
            border-left-color: var(--primary-color);
        }

        .alert-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning-color);
            border-left-color: var(--warning-color);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –¥–Ω–µ–π –∏ —Å—Ç–∏–ª–µ–π */
        .grid-buttons {
            display: grid;
            gap: 12px;
            margin: 20px 0;
        }

        .grid-2 {
            grid-template-columns: 1fr 1fr;
        }

        .grid-4 {
            grid-template-columns: repeat(4, 1fr);
        }

        .grid-8 {
            grid-template-columns: repeat(4, 1fr);
        }

        .grid-btn {
            background: var(--card-bg);
            border: 2px solid var(--border-color);
            border-radius: 14px;
            padding: 14px 10px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
            font-weight: 500;
            color: var(--text-color);
        }

        .grid-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(99, 102, 241, 0.3);
        }

        .grid-btn:active {
            transform: scale(0.96);
        }

        /* –í—ã–≤–æ–¥ –æ—Ç—á–µ—Ç–∞ */
        .output-container {
            background: var(--card-bg);
            border-radius: 14px;
            padding: 24px;
            margin-top: 24px;
            border: 1px solid var(--border-color);
            white-space: pre-wrap;
            font-family: 'JetBrains Mono', 'Fira Code', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            max-height: 500px;
            overflow-y: auto;
            transition: all 0.3s ease;
        }

        .output-container:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        /* –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö */
        .search-box {
            position: relative;
            margin-bottom: 24px;
        }

        .search-box input {
            padding-left: 48px;
        }

        .search-icon {
            position: absolute;
            left: 16px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-light);
            z-index: 2;
        }

        .reports-list {
            max-height: 600px;
            overflow-y: auto;
        }

        .report-item {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 12px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .report-item:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .report-item:active {
            transform: scale(0.99);
        }

        .report-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .report-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--text-color);
        }

        .report-meta {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            font-size: 0.85rem;
            color: var(--text-light);
        }

        .report-actions {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            padding: 8px 12px;
            border: none;
            border-radius: 10px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        /* –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin: 24px 0;
        }

        .stat-card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: var(--shadow-hover);
        }

        .stat-value {
            font-size: 1.8rem;
            font-weight: 800;
            color: var(--primary-color);
            margin: 8px 0;
            letter-spacing: -0.025em;
        }

        .stat-label {
            font-size: 0.85rem;
            color: var(--text-light);
            font-weight: 500;
        }

        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
            
            .nav-tab {
                font-size: 0.7rem;
                padding: 14px 6px;
            }
            
            .grid-4, .grid-8 {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .tab-content {
                padding: 20px 16px;
            }

            .card {
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .app-header h1 {
                font-size: 1.4rem;
            }
            
            .grid-2 {
                grid-template-columns: 1fr;
            }

            .grid-4, .grid-8 {
                grid-template-columns: 1fr;
            }
        }

        /* –£—Ç–∏–ª–∏—Ç—ã */
        .text-center { text-align: center; }
        .mt-10 { margin-top: 10px; }
        .mt-20 { margin-top: 20px; }
        .mb-10 { margin-bottom: 10px; }
        .mb-20 { margin-bottom: 20px; }
        .hidden { display: none; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .justify-between { justify-content: space-between; }
        .gap-10 { gap: 10px; }

        /* –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Ç–µ–º—ã */
        .theme-toggle {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            border: none;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            z-index: 1000;
            transition: all 0.3s ease;
        }

        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .shake {
            animation: shake 0.5s;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-6px); }
            75% { transform: translateX(6px); }
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ */
        .settings-group {
            margin-bottom: 28px;
        }

        .settings-label {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--text-color);
            font-size: 1rem;
        }

        .settings-description {
            font-size: 0.85rem;
            color: var(--text-light);
            margin-bottom: 16px;
        }

        /* –ß–µ–∫–±–æ–∫—Å—ã –∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏ */
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 52px;
            height: 28px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: var(--border-color);
            transition: .4s;
            border-radius: 34px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 20px;
            width: 20px;
            left: 4px;
            bottom: 4px;
            background: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background: var(--primary-color);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(24px);
        }

        .toggle-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .toggle-label {
            font-weight: 500;
            color: var(--text-color);
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ */
        .inspection-fields {
            background: rgba(99, 102, 241, 0.05);
            border-radius: 14px;
            padding: 20px;
            margin-top: 16px;
            border: 2px dashed var(--primary-color);
        }

        .inspection-item {
            background: var(--card-bg);
            border-radius: 14px;
            padding: 20px;
            margin-bottom: 16px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
        }

        .inspection-item.urgent {
            border-left: 4px solid var(--warning-color);
        }

        .inspection-item.completed {
            opacity: 0.7;
            background: rgba(16, 185, 129, 0.05);
        }

        .inspection-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 12px;
        }

        .inspection-title {
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--text-color);
        }

        .inspection-date {
            font-size: 0.9rem;
            color: var(--text-light);
            background: var(--primary-color);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-weight: 600;
        }

        .inspection-details {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            font-size: 0.85rem;
            margin-bottom: 16px;
        }

        .inspection-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-right: 8px;
            margin-bottom: 8px;
        }

        .badge-warning {
            background: rgba(245, 158, 11, 0.1);
            color: var(--warning-color);
        }

        .badge-success {
            background: rgba(16, 185, 129, 0.1);
            color: var(--success-color);
        }

        .badge-info {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary-color);
        }

        /* –ü–æ–ª–µ –≤–≤–æ–¥–∞ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è */
        .reminder-input {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-top: 12px;
        }

        .reminder-input input {
            flex: 1;
            max-width: 100px;
        }

        .reminder-label {
            font-size: 0.9rem;
            color: var(--text-light);
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- –®–∞–ø–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
        <header class="app-header">
            <h1>üèçÔ∏è –ú–æ—Ç–æ–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ PRO</h1>
            <p>–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π –ø–æ–¥–±–æ—Ä –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –º–æ—Ç–æ—Ü–∏–∫–ª–æ–≤</p>
        </header>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <nav class="nav-tabs">
            <button class="nav-tab active" data-tab="report">üìä –û—Ç—á–µ—Ç</button>
            <button class="nav-tab" data-tab="inspections">üìÖ –ü—Ä–æ–≤–µ—Ä–∫–∏</button>
            <button class="nav-tab" data-tab="database">üóÉÔ∏è –ë–∞–∑–∞</button>
            <button class="nav-tab" data-tab="stats">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
            <button class="nav-tab" data-tab="settings">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </nav>

        <!-- –í–∫–ª–∞–¥–∫–∞ –û–¢–ß–ï–¢ -->
        <div id="report-tab" class="tab-content active">
            <div class="card">
                <h2 class="section-title">–°–æ–∑–¥–∞–Ω–∏–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ—Ç—á–µ—Ç–∞</h2>
                
                <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
                <div class="progress-container">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="progress-text" id="progressText">–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
                </div>

                <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è -->
                <div class="alert alert-success hidden" id="successAlert"></div>
                <div class="alert alert-info hidden" id="savingsAlert"></div>

                <form id="diagnosticForm">
                    <!-- –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
                    <div class="section-title">üìã –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
                    <div class="card">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="brand">–ú–∞—Ä–∫–∞ –º–æ—Ç–æ—Ü–∏–∫–ª–∞</label>
                                <select id="brand" name="brand" required>
                                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫—É --</option>
                                    <option value="Yamaha">Yamaha</option>
                                    <option value="Honda">Honda</option>
                                    <option value="Kawasaki">Kawasaki</option>
                                    <option value="Suzuki">Suzuki</option>
                                    <option value="BMW">BMW</option>
                                    <option value="KTM">KTM</option>
                                    <option value="Ducati">Ducati</option>
                                    <option value="Triumph">Triumph</option>
                                    <option value="Harley-Davidson">Harley-Davidson</option>
                                    <option value="–î—Ä—É–≥–∞—è –º–∞—Ä–∫–∞">–î—Ä—É–≥–∞—è –º–∞—Ä–∫–∞</option>
                                </select>
                                <input type="text" id="brand_custom" name="brand_custom" placeholder="–í–≤–µ–¥–∏—Ç–µ –º–∞—Ä–∫—É" class="hidden mt-10">
                            </div>

                            <div class="form-group">
                                <label for="model">–ú–æ–¥–µ–ª—å</label>
                                <select id="model" name="model" required>
                                    <option value="">-- –°–Ω–∞—á–∞–ª–∞ –≤—ã–±–µ—Ä–∏—Ç–µ –º–∞—Ä–∫—É --</option>
                                </select>
                                <input type="text" id="model_custom" name="model_custom" placeholder="–í–≤–µ–¥–∏—Ç–µ –º–æ–¥–µ–ª—å" class="hidden mt-10">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="year">–ì–æ–¥ –≤—ã–ø—É—Å–∫–∞</label>
                                <input type="number" id="year" name="year" placeholder="2023" min="1990" max="2025" required>
                            </div>

                            <div class="form-group">
                                <label for="mileage">–ü—Ä–æ–±–µ–≥ (—Ç—ã—Å. –∫–º)</label>
                                <input type="number" id="mileage" name="mileage" placeholder="15.5" step="0.1" min="0">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="motorcycle_class">–ö–ª–∞—Å—Å –º–æ—Ç–æ—Ü–∏–∫–ª–∞</label>
                                <select id="motorcycle_class" name="motorcycle_class">
                                    <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –∫–ª–∞—Å—Å --</option>
                                    <option value="–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π</option>
                                    <option value="–ù–µ–π–∫–µ–¥">–ù–µ–π–∫–µ–¥</option>
                                    <option value="–°–∫—Ä—ç–º–±–ª–µ—Ä">–°–∫—Ä—ç–º–±–ª–µ—Ä</option>
                                    <option value="–°–ø–æ—Ä—Ç–±–∞–π–∫">–°–ø–æ—Ä—Ç–±–∞–π–∫</option>
                                    <option value="–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π">–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–π</option>
                                    <option value="–ì–∏–ø–µ—Ä–±–∞–π–∫">–ì–∏–ø–µ—Ä–±–∞–π–∫</option>
                                    <option value="–¢—É—Ä—ç–Ω–¥—É—Ä–æ">–¢—É—Ä—ç–Ω–¥—É—Ä–æ</option>
                                    <option value="–ö—Ä—É–∏–∑–µ—Ä">–ö—Ä—É–∏–∑–µ—Ä</option>
                                    <option value="–ú—É—Å–∫—É–ª–±–∞–π–∫">–ú—É—Å–∫—É–ª–±–∞–π–∫</option>
                                    <option value="–ë–æ–±–±–µ—Ä">–ë–æ–±–±–µ—Ä</option>
                                    <option value="–ö–∞—Ñ–µ-—Ä–µ–π—Å–µ—Ä">–ö–∞—Ñ–µ-—Ä–µ–π—Å–µ—Ä</option>
                                    <option value="–ú–æ—Ç–æ—Ü–∏–∫–ª —Å –∫–æ–ª—è—Å–∫–æ–π">–ú–æ—Ç–æ—Ü–∏–∫–ª —Å –∫–æ–ª—è—Å–∫–æ–π</option>
                                    <option value="–ö–∞—Å—Ç–æ–º">–ö–∞—Å—Ç–æ–º</option>
                                    <option value="–ß–æ–ø–ø–µ—Ä">–ß–æ–ø–ø–µ—Ä</option>
                                    <option value="–ú–∏–Ω–∏-–±–∞–π–∫">–ú–∏–Ω–∏-–±–∞–π–∫</option>
                                    <option value="–¢—Ä–∞–π–∫">–¢—Ä–∞–π–∫</option>
                                    <option value="–ú–∞–∫—Å–∏-—Å–∫—É—Ç–µ—Ä">–ú–∞–∫—Å–∏-—Å–∫—É—Ç–µ—Ä</option>
                                    <option value="–ö—Ä–æ—Å—Å–æ–≤—ã–π">–ö—Ä–æ—Å—Å–æ–≤—ã–π</option>
                                    <option value="–≠–Ω–¥—É—Ä–æ">–≠–Ω–¥—É—Ä–æ</option>
                                    <option value="–ú–æ—Ç–∞—Ä–¥">–ú–æ—Ç–∞—Ä–¥</option>
                                    <option value="–°—É–ø–µ—Ä–º–æ—Ç–æ">–°—É–ø–µ—Ä–º–æ—Ç–æ</option>
                                    <option value="–¢—Ä–∏–∞–ª–±–∞–π–∫">–¢—Ä–∏–∞–ª–±–∞–π–∫</option>
                                    <option value="–ü–∏—Ç–±–∞–π–∫">–ü–∏—Ç–±–∞–π–∫</option>
                                    <option value="–ú–æ–ø–µ–¥">–ú–æ–ø–µ–¥</option>
                                    <option value="–°–∫—É—Ç–µ—Ä">–°–∫—É—Ç–µ—Ä</option>
                                    <option value="–°–∫—É—Ç–µ—Ä–µ—Ç—Ç–∞">–°–∫—É—Ç–µ—Ä–µ—Ç—Ç–∞</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="legal_check">–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞</label>
                                <select id="legal_check" name="legal_check">
                                    <option value="–ü—Ä–æ–≤–µ–¥–µ–Ω–∞">‚úÖ –ü—Ä–æ–≤–µ–¥–µ–Ω–∞</option>
                                    <option value="–ù–µ –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å">‚ùå –ù–µ –ø—Ä–æ–≤–æ–¥–∏–ª–∞—Å—å</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ -->
                    <div class="section-title">üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ</div>
                    <div class="card">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="price">–¶–µ–Ω–∞ –ø—Ä–æ–¥–∞–≤—Ü–∞</label>
                                <input type="text" id="price" name="price" placeholder="350 000 —Ä—É–±">
                            </div>

                            <div class="form-group">
                                <label for="objective_cost">–û–±—ä–µ–∫—Ç–∏–≤–Ω–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å</label>
                                <input type="text" id="objective_cost" name="objective_cost" placeholder="320 000 —Ä—É–±">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="seller_discount">–°–∫–∏–¥–∫–∞ —Å –ø—Ä–æ–¥–∞–≤—Ü–∞</label>
                                <input type="text" id="seller_discount" name="seller_discount" placeholder="15 000 —Ä—É–±">
                            </div>

                            <div class="form-group">
                                <label for="investment_cost">–°—Ç–æ–∏–º–æ—Å—Ç—å –≤–ª–æ–∂–µ–Ω–∏–π</label>
                                <input type="text" id="investment_cost" name="investment_cost" placeholder="5 000 —Ä—É–±">
                            </div>
                        </div>
                    </div>

                    <!-- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ -->
                    <div class="section-title">üîß –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞</div>
                    <div class="card">
                        <div class="form-row">
                            <div class="form-group">
                                <label for="appearance_rating">–í–Ω–µ—à–Ω–∏–π –≤–∏–¥ (1-5)</label>
                                <input type="number" id="appearance_rating" name="appearance_rating" min="1" max="5" placeholder="5">
                            </div>

                            <div class="form-group">
                                <label for="engine_rating">–î–≤–∏–≥–∞—Ç–µ–ª—å/–ö–ü–ü (1-5)</label>
                                <input type="number" id="engine_rating" name="engine_rating" min="1" max="5" placeholder="5">
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="electronics_rating">–≠–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (1-5)</label>
                                <input type="number" id="electronics_rating" name="electronics_rating" min="1" max="5" placeholder="4">
                            </div>

                            <div class="form-group">
                                <label for="suspension_rating">–ü–æ–¥–≤–µ—Å–∫–∞ (1-5)</label>
                                <input type="number" id="suspension_rating" name="suspension_rating" min="1" max="5" placeholder="4">
                            </div>
                        </div>
                    </div>

                    <!-- –í—ã–≤–æ–¥—ã –∏ —Ä–µ—à–µ–Ω–∏–µ -->
                    <div class="section-title">üí° –í—ã–≤–æ–¥—ã –∏ —Ä–µ—à–µ–Ω–∏–µ</div>
                    <div class="card">
                        <div class="form-group">
                            <label for="key_finding">–ö–ª—é—á–µ–≤–∞—è –Ω–∞—Ö–æ–¥–∫–∞</label>
                            <input type="text" id="key_finding" name="key_finding" placeholder="–û—Ç–ª–∏—á–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –¥–≤–∏–≥–∞—Ç–µ–ª—è">
                        </div>

                        <div class="form-group">
                            <label for="expert_verdict">–≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –≤–µ—Ä–¥–∏–∫—Ç</label>
                            <textarea id="expert_verdict" name="expert_verdict" rows="3" placeholder="–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–µ –º–Ω–µ–Ω–∏–µ..."></textarea>
                        </div>

                        <div class="form-group">
                            <label for="decision">–†–µ—à–µ–Ω–∏–µ</label>
                            <select id="decision" name="decision">
                                <option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ—à–µ–Ω–∏–µ --</option>
                                <option value="‚úÖ –ö—É–ø–ª–µ–Ω">‚úÖ –ö—É–ø–ª–µ–Ω</option>
                                <option value="‚ùå –ù–µ –ö—É–ø–ª–µ–Ω">‚ùå –ù–µ –ö—É–ø–ª–µ–Ω</option>
                                <option value="üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É">üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É</option>
                            </select>
                        </div>

                        <!-- –ü–æ–ª—è –¥–ª—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ -->
                        <div class="inspection-fields hidden" id="inspectionFields">
                            <div class="section-title" style="font-size: 1rem;">üìÖ –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏</div>
                            
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="inspection_date">–î–∞—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏</label>
                                    <input type="date" id="inspection_date" name="inspection_date">
                                </div>

                                <div class="form-group">
                                    <label for="inspection_time">–í—Ä–µ–º—è –ø—Ä–æ–≤–µ—Ä–∫–∏</label>
                                    <input type="time" id="inspection_time" name="inspection_time">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="inspection_address">–ê–¥—Ä–µ—Å –ø—Ä–æ–≤–µ—Ä–∫–∏</label>
                                <input type="text" id="inspection_address" name="inspection_address" placeholder="–≥. –ú–æ—Å–∫–≤–∞, —É–ª. –ü—Ä–∏–º–µ—Ä–Ω–∞—è, –¥. 1">
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="customer_phone">–¢–µ–ª–µ—Ñ–æ–Ω –∑–∞–∫–∞–∑—á–∏–∫–∞</label>
                                    <input type="tel" id="customer_phone" name="customer_phone" placeholder="+7 (900) 123-45-67">
                                </div>

                                <div class="form-group">
                                    <label for="seller_phone">–¢–µ–ª–µ—Ñ–æ–Ω –ø—Ä–æ–¥–∞–≤—Ü–∞</label>
                                    <input type="tel" id="seller_phone" name="seller_phone" placeholder="+7 (900) 765-43-21">
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="inspection_notes">–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏</label>
                                <textarea id="inspection_notes" name="inspection_notes" rows="2" placeholder="–û—Å–æ–±—ã–µ —É—Å–ª–æ–≤–∏—è, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏..."></textarea>
                            </div>
                        </div>
                    </div>

                    <!-- –°—Ç–∏–ª—å –ø–æ—Å—Ç–∞ -->
                    <div class="section-title">üé® –°—Ç–∏–ª—å –æ—Ç—á–µ—Ç–∞</div>
                    <div class="card">
                        <div class="grid-buttons grid-2">
                            <button type="button" class="grid-btn active" data-style="problem_solution">üö® –ü—Ä–æ–±–ª–µ–º–∞/–†–µ—à–µ–Ω–∏–µ</button>
                            <button type="button" class="grid-btn" data-style="structured">üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π</button>
                            <button type="button" class="grid-btn" data-style="story">üìñ –ò—Å—Ç–æ—Ä–∏—è</button>
                            <button type="button" class="grid-btn" data-style="original">üìã –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π</button>
                        </div>
                    </div>

                    <!-- –¢–∏–ø –ø–æ—Å—Ç–∞ -->
                    <div class="section-title">üìÖ –¢–∏–ø –ø–æ—Å—Ç–∞</div>
                    <div class="card">
                        <div class="grid-buttons grid-8">
                            <button type="button" class="grid-btn active" data-day="monday">–ü–ù</button>
                            <button type="button" class="grid-btn" data-day="tuesday">–í–¢</button>
                            <button type="button" class="grid-btn" data-day="wednesday">–°–†</button>
                            <button type="button" class="grid-btn" data-day="thursday">–ß–¢</button>
                            <button type="button" class="grid-btn" data-day="friday">–ü–¢</button>
                            <button type="button" class="grid-btn" data-day="saturday">–°–ë</button>
                            <button type="button" class="grid-btn" data-day="sunday">–í–°</button>
                            <button type="button" class="grid-btn" data-day="simple">–ü—Ä–æ—Å—Ç–æ–π</button>
                        </div>
                    </div>

                    <!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
                    <button type="button" class="btn pulse" id="generateBtn">
                        üîÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç
                    </button>
                    
                    <div class="form-row mt-10">
                        <button type="button" class="btn btn-secondary" id="saveToDbBtn">
                            üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –±–∞–∑—É
                        </button>
                        <button type="button" class="btn btn-warning" id="clearFormBtn">
                            üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É
                        </button>
                    </div>
                </form>
            </div>

            <!-- –í—ã–≤–æ–¥ –æ—Ç—á–µ—Ç–∞ -->
            <div class="card hidden" id="outputCard">
                <div class="section-title">üìÑ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç</div>
                <div class="output-container" id="output"></div>
                <button type="button" class="btn btn-success mt-10 hidden" id="copyBtn">
                    üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç—á–µ—Ç
                </button>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ó–ê–ü–õ–ê–ù–ò–†–û–í–ê–ù–ù–´–ï –ü–†–û–í–ï–†–ö–ò -->
        <div id="inspections-tab" class="tab-content">
            <div class="card">
                <h2 class="section-title">üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏</h2>
                
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="searchInspections" placeholder="–ü–æ–∏—Å–∫ –ø–æ –º–∞—Ä–∫–µ, –º–æ–¥–µ–ª–∏ –∏–ª–∏ –∞–¥—Ä–µ—Å—É...">
                </div>

                <div class="form-row">
                    <button class="btn btn-secondary" id="exportInspectionsBtn">
                        üì§ –≠–∫—Å–ø–æ—Ä—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫
                    </button>
                    <button class="btn btn-warning" id="importInspectionsBtn">
                        üì• –ò–º–ø–æ—Ä—Ç –ø—Ä–æ–≤–µ—Ä–æ–∫
                    </button>
                </div>

                <div class="reports-list" id="inspectionsList">
                    <!-- –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ë–ê–ó–ê –î–ê–ù–ù–´–• -->
        <div id="database-tab" class="tab-content">
            <div class="card">
                <h2 class="section-title">üóÉÔ∏è –ë–∞–∑–∞ –æ—Ç—á–µ—Ç–æ–≤</h2>
                
                <div class="search-box">
                    <span class="search-icon">üîç</span>
                    <input type="text" id="searchReports" placeholder="–ü–æ–∏—Å–∫ –ø–æ –º–∞—Ä–∫–µ, –º–æ–¥–µ–ª–∏ –∏–ª–∏ –≥–æ–¥—É...">
                </div>

                <div class="form-row">
                    <button class="btn btn-secondary" id="exportBtn">üì§ –≠–∫—Å–ø–æ—Ä—Ç –±–∞–∑—ã</button>
                    <button class="btn btn-warning" id="importBtn">üì• –ò–º–ø–æ—Ä—Ç –±–∞–∑—ã</button>
                </div>

                <div class="reports-list" id="reportsList">
                    <!-- –û—Ç—á–µ—Ç—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∑–¥–µ—Å—å -->
                </div>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –°–¢–ê–¢–ò–°–¢–ò–ö–ê -->
        <div id="stats-tab" class="tab-content">
            <div class="card">
                <h2 class="section-title">üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h2>
                
                <div class="grid-buttons grid-4">
                    <button class="grid-btn active" data-period="week">–ù–µ–¥–µ–ª—è</button>
                    <button class="grid-btn" data-period="month">–ú–µ—Å—è—Ü</button>
                    <button class="grid-btn" data-period="quarter">–ö–≤–∞—Ä—Ç–∞–ª</button>
                    <button class="grid-btn" data-period="year">–ì–æ–¥</button>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">–í—Å–µ–≥–æ –æ—Ç—á–µ—Ç–æ–≤</div>
                        <div class="stat-value" id="totalReports">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–£—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫</div>
                        <div class="stat-value" id="successfulDeals">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–°—Ä–µ–¥–Ω—è—è —ç–∫–æ–Ω–æ–º–∏—è</div>
                        <div class="stat-value" id="avgSavings">0 ‚ÇΩ</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–ü–æ–ø—É–ª—è—Ä–Ω–∞—è –º–∞—Ä–∫–∞</div>
                        <div class="stat-value" id="popularBrand">-</div>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-label">–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–æ–≤–µ—Ä–æ–∫</div>
                        <div class="stat-value" id="plannedInspections">0</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">–í—ã–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ–≤–µ—Ä–æ–∫</div>
                        <div class="stat-value" id="completedInspections">0</div>
                    </div>
                </div>

                <button class="btn btn-secondary" id="generateStatsBtn">
                    üìä –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
                </button>

                <div class="output-container hidden mt-20" id="statsOutput"></div>
                <button class="btn btn-success mt-10 hidden" id="copyStatsBtn">
                    üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                </button>
            </div>
        </div>

        <!-- –í–∫–ª–∞–¥–∫–∞ –ù–ê–°–¢–†–û–ô–ö–ò -->
        <div id="settings-tab" class="tab-content">
            <div class="card">
                <h2 class="section-title">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h2>
                
                <div class="settings-group">
                    <div class="settings-label">–í–Ω–µ—à–Ω–∏–π –≤–∏–¥</div>
                    <div class="settings-description">–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ç–µ–º—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div>
                    
                    <div class="toggle-container">
                        <span class="toggle-label">–¢–µ–º–Ω–∞—è —Ç–µ–º–∞</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="darkTheme">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="toggle-container">
                        <span class="toggle-label">–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="autoSave" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>

                <div class="settings-group">
                    <div class="settings-label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</div>
                    <div class="settings-description">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è–º–∏</div>
                    
                    <div class="toggle-container">
                        <span class="toggle-label">–ó–≤—É–∫–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="soundNotifications" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                    
                    <div class="toggle-container">
                        <span class="toggle-label">–í–∏–±—Ä–æ–æ—Ç–∫–ª–∏–∫</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="vibration" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="toggle-container">
                        <span class="toggle-label">–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–æ–≤–µ—Ä–∫–∞—Ö</span>
                        <label class="toggle-switch">
                            <input type="checkbox" id="inspectionNotifications" checked>
                            <span class="toggle-slider"></span>
                        </label>
                    </div>

                    <div class="reminder-input">
                        <label class="reminder-label">–ù–∞–ø–æ–º–∏–Ω–∞—Ç—å –∑–∞:</label>
                        <input type="number" id="reminderTime" name="reminderTime" min="1" max="24" value="2">
                        <span class="reminder-label">—á–∞—Å–∞</span>
                    </div>
                </div>

                <div class="settings-group">
                    <div class="settings-label">–†–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏</div>
                    <div class="settings-description">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è</div>
                    
                    <div class="form-row">
                        <button class="btn btn-secondary" id="exportSettingsBtn">
                            üíæ –≠–∫—Å–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫
                        </button>
                        <button class="btn btn-warning" id="importSettingsBtn">
                            üì• –ò–º–ø–æ—Ä—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫
                        </button>
                    </div>
                    
                    <button class="btn btn-danger mt-10" id="clearStorageBtn">
                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
                    </button>
                </div>
            </div>

            <div class="card mt-20">
                <h2 class="section-title">‚ÑπÔ∏è –û –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏</h2>
                <div class="settings-group">
                    <p><strong>–í–µ—Ä—Å–∏—è:</strong> 2.2.0 PRO</p>
                    <p><strong>–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫:</strong> –°–µ—Ä–≥–µ–π –õ–∞–Ω–¥–∏–∫</p>
                    <p><strong>–ö–æ–Ω—Ç–∞–∫—Ç—ã:</strong> 8 950 005-05-08</p>
                    <p><strong>–°–∞–π—Ç:</strong> motopodbor.ru</p>
                    <p><strong>–û–±–Ω–æ–≤–ª–µ–Ω–æ:</strong> <span id="appVersionDate">2024</span></p>
                </div>
                
                <button class="btn mt-20" id="installBtn" style="display: none;">
                    üì≤ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
                </button>
            </div>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã -->
    <button class="theme-toggle" id="themeToggle">üåì</button>

    <script>
        // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π
        const modelsDatabase = {
            "Yamaha": ["MT-07", "MT-09", "YZF-R1", "YZF-R6", "YZF-R3", "XMAX", "TMAX", "Tracer 9", "XSR900"],
            "Honda": ["CBR1000RR", "CBR650R", "CB500F", "Africa Twin", "Rebel 500", "Gold Wing", "NC750X"],
            "Kawasaki": ["Ninja ZX-10R", "Ninja 650", "Z900", "Versys 650", "Vulcan S", "KLX230"],
            "Suzuki": ["GSX-R1000", "GSX-R750", "GSX-S1000", "V-Strom 650", "SV650", "Hayabusa"],
            "BMW": ["S1000RR", "R1250GS", "F900R", "R18", "C400X"],
            "KTM": ["1290 Super Duke R", "790 Duke", "390 Duke", "690 Enduro"],
            "Ducati": ["Panigale V4", "Monster", "Scrambler", "Multistrada", "Streetfighter"],
            "Triumph": ["Street Triple", "Speed Triple", "Tiger 900", "Bonneville", "Rocket 3"],
            "Harley-Davidson": ["Street Glide", "Sportster", "Fat Boy", "Softail", "Pan America"],
            "–î—Ä—É–≥–∞—è –º–∞—Ä–∫–∞": ["–î—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å"]
        };

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let reportsDatabase = JSON.parse(localStorage.getItem('motodiag_reports')) || [];
        let inspectionsDatabase = JSON.parse(localStorage.getItem('motodiag_inspections')) || [];
        let selectedDay = 'monday';
        let selectedStyle = 'problem_solution';
        let deferredPrompt = null;
        let notificationTimeouts = [];

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            initializeTheme();
            initializeNavigation();
            initializeEventListeners();
            initializeForm();
            loadReportsList();
            loadInspectionsList();
            updateStatistics();
            checkPWAInstall();
            scheduleInspectionNotifications();
        }

        function initializeTheme() {
            const savedTheme = localStorage.getItem('motodiag_theme') || 'light';
            document.body.setAttribute('data-theme', savedTheme);
            document.getElementById('darkTheme').checked = savedTheme === 'dark';
        }

        function initializeNavigation() {
            const navTabs = document.querySelectorAll('.nav-tab');
            const tabContents = document.querySelectorAll('.tab-content');
            
            navTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    
                    // –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –≤–∫–ª–∞–¥–∫—É
                    navTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        if (content.id === `${tabId}-tab`) {
                            content.classList.add('active');
                        }
                    });
                    
                    // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
                    if (tabId === 'database') loadReportsList();
                    if (tabId === 'inspections') loadInspectionsList();
                    if (tabId === 'stats') updateStatistics();
                });
            });
        }

        function initializeEventListeners() {
            // –û—Å–Ω–æ–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
            document.getElementById('generateBtn').addEventListener('click', generateReport);
            document.getElementById('copyBtn').addEventListener('click', copyToClipboard);
            document.getElementById('saveToDbBtn').addEventListener('click', saveReportToDatabase);
            document.getElementById('clearFormBtn').addEventListener('click', clearForm);
            
            // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ —Ä–µ—à–µ–Ω–∏—è
            document.getElementById('decision').addEventListener('change', function() {
                const inspectionFields = document.getElementById('inspectionFields');
                if (this.value === 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É') {
                    inspectionFields.classList.remove('hidden');
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –¥–∞—Ç—É –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (–∑–∞–≤—Ç—Ä–∞)
                    const tomorrow = new Date();
                    tomorrow.setDate(tomorrow.getDate() + 1);
                    document.getElementById('inspection_date').value = tomorrow.toISOString().split('T')[0];
                    // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Ä–µ–º—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (10:00)
                    document.getElementById('inspection_time').value = '10:00';
                } else {
                    inspectionFields.classList.add('hidden');
                }
            });
            
            // –ö–Ω–æ–ø–∫–∏ —Å—Ç–∏–ª–µ–π –∏ –¥–Ω–µ–π
            document.querySelectorAll('.grid-btn[data-style]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.grid-btn[data-style]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    selectedStyle = this.getAttribute('data-style');
                });
            });
            
            document.querySelectorAll('.grid-btn[data-day]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.grid-btn[data-day]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    selectedDay = this.getAttribute('data-day');
                });
            });
            
            // –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
            document.getElementById('searchReports').addEventListener('input', loadReportsList);
            document.getElementById('exportBtn').addEventListener('click', exportDatabase);
            document.getElementById('importBtn').addEventListener('click', importDatabase);
            
            // –ü—Ä–æ–≤–µ—Ä–∫–∏
            document.getElementById('searchInspections').addEventListener('input', loadInspectionsList);
            document.getElementById('exportInspectionsBtn').addEventListener('click', exportInspections);
            document.getElementById('importInspectionsBtn').addEventListener('click', importInspections);
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
            document.querySelectorAll('.grid-btn[data-period]').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.grid-btn[data-period]').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    updateStatistics(this.getAttribute('data-period'));
                });
            });
            
            document.getElementById('generateStatsBtn').addEventListener('click', generateStatsPost);
            document.getElementById('copyStatsBtn').addEventListener('click', copyStatsToClipboard);
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
            document.getElementById('darkTheme').addEventListener('change', toggleTheme);
            document.getElementById('clearStorageBtn').addEventListener('click', clearAllData);
            document.getElementById('installBtn').addEventListener('click', installPWA);
            document.getElementById('exportSettingsBtn').addEventListener('click', exportSettings);
            document.getElementById('importSettingsBtn').addEventListener('click', importSettings);
            document.getElementById('themeToggle').addEventListener('click', toggleThemeManual);
            
            // –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
            document.querySelectorAll('#diagnosticForm input, #diagnosticForm select, #diagnosticForm textarea').forEach(input => {
                input.addEventListener('input', debounce(() => {
                    if (document.getElementById('autoSave').checked) {
                        saveFormData();
                    }
                }, 1000));
            });
            
            // –í—ã–±–æ—Ä –º–∞—Ä–∫–∏
            document.getElementById('brand').addEventListener('change', function() {
                updateModelOptions(this.value);
                if (this.value === '–î—Ä—É–≥–∞—è –º–∞—Ä–∫–∞') {
                    document.getElementById('brand_custom').classList.remove('hidden');
                } else {
                    document.getElementById('brand_custom').classList.add('hidden');
                }
            });
        }

        function initializeForm() {
            // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
            loadFormData();
            updateProgress();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞ –º–æ–¥–µ–ª–µ–π
            const savedBrand = document.getElementById('brand').value;
            if (savedBrand) {
                updateModelOptions(savedBrand);
            }
            
            // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
            const reminderTime = localStorage.getItem('motodiag_reminder_time');
            if (reminderTime) {
                document.getElementById('reminderTime').value = reminderTime;
            }
        }

        function updateModelOptions(brand) {
            const modelSelect = document.getElementById('model');
            modelSelect.innerHTML = '<option value="">-- –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å --</option>';
            
            if (brand && modelsDatabase[brand]) {
                modelsDatabase[brand].forEach(model => {
                    const option = document.createElement('option');
                    option.value = model;
                    option.textContent = model;
                    modelSelect.appendChild(option);
                });
            }
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–ø—Ü–∏—é –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –º–æ–¥–µ–ª–∏
            const customOption = document.createElement('option');
            customOption.value = '–î—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å';
            customOption.textContent = '–î—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å';
            modelSelect.appendChild(customOption);
            
            modelSelect.addEventListener('change', function() {
                if (this.value === '–î—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å') {
                    document.getElementById('model_custom').classList.remove('hidden');
                } else {
                    document.getElementById('model_custom').classList.add('hidden');
                }
            });
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å
            const savedModel = localStorage.getItem('motodiag_model');
            if (savedModel) {
                modelSelect.value = savedModel;
                if (savedModel === '–î—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å') {
                    document.getElementById('model_custom').classList.remove('hidden');
                }
            }
        }

        function updateProgress() {
            const requiredFields = ['brand', 'model', 'year'];
            const filledFields = requiredFields.filter(field => {
                const element = document.getElementById(field);
                return element && element.value.trim() !== '';
            }).length;
            
            const progress = (filledFields / requiredFields.length) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
            
            const progressText = document.getElementById('progressText');
            if (progress === 100) {
                progressText.textContent = '‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã!';
                progressText.style.color = 'var(--success-color)';
            } else {
                progressText.textContent = `–ó–∞–ø–æ–ª–Ω–µ–Ω–æ ${filledFields} –∏–∑ ${requiredFields.length} –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø–æ–ª–µ–π`;
                progressText.style.color = 'var(--text-light)';
            }
        }

        function saveFormData() {
            const formData = new FormData(document.getElementById('diagnosticForm'));
            const data = {};
            
            for (let [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            localStorage.setItem('motodiag_form_data', JSON.stringify(data));
            showAlert('–î–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        }

        function loadFormData() {
            const savedData = localStorage.getItem('motodiag_form_data');
            if (savedData) {
                const data = JSON.parse(savedData);
                
                Object.keys(data).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.value = data[key];
                    }
                });
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–¥–µ–ª–∏ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –±—Ä–µ–Ω–¥–∞
                if (data.brand) {
                    setTimeout(() => {
                        updateModelOptions(data.brand);
                        if (data.model === '–î—Ä—É–≥–∞—è –º–æ–¥–µ–ª—å') {
                            document.getElementById('model_custom').classList.remove('hidden');
                        }
                        if (data.brand === '–î—Ä—É–≥–∞—è –º–∞—Ä–∫–∞') {
                            document.getElementById('brand_custom').classList.remove('hidden');
                        }
                        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
                        if (data.decision === 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É') {
                            document.getElementById('inspectionFields').classList.remove('hidden');
                        }
                    }, 100);
                }
            }
        }

        function clearForm() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –ø–æ–ª—è —Ñ–æ—Ä–º—ã?')) {
                document.getElementById('diagnosticForm').reset();
                localStorage.removeItem('motodiag_form_data');
                document.getElementById('outputCard').classList.add('hidden');
                document.getElementById('savingsAlert').classList.add('hidden');
                document.getElementById('inspectionFields').classList.add('hidden');
                updateProgress();
                showAlert('–§–æ—Ä–º–∞ –æ—á–∏—â–µ–Ω–∞', 'success');
            }
        }

        function validateForm() {
            const requiredFields = ['brand', 'model', 'year'];
            let isValid = true;
            
            requiredFields.forEach(field => {
                const element = document.getElementById(field);
                if (!element || !element.value.trim()) {
                    isValid = false;
                    element.style.borderColor = 'var(--danger-color)';
                } else {
                    element.style.borderColor = '';
                }
            });
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª—è –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
            const decision = document.getElementById('decision').value;
            if (decision === 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É') {
                const inspectionFields = ['inspection_date', 'inspection_time', 'inspection_address', 'customer_phone'];
                inspectionFields.forEach(field => {
                    const element = document.getElementById(field);
                    if (!element || !element.value.trim()) {
                        isValid = false;
                        element.style.borderColor = 'var(--danger-color)';
                    } else {
                        element.style.borderColor = '';
                    }
                });
            }
            
            if (!isValid) {
                showAlert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è', 'warning');
                document.getElementById('generateBtn').classList.add('shake');
                setTimeout(() => {
                    document.getElementById('generateBtn').classList.remove('shake');
                }, 500);
            }
            
            return isValid;
        }

        function generateReport() {
            if (!validateForm()) return;
            
            const formData = new FormData(document.getElementById('diagnosticForm'));
            const data = Object.fromEntries(formData.entries());
            
            // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞
            const report = generateReportText(data, selectedDay, selectedStyle);
            document.getElementById('output').textContent = report;
            document.getElementById('outputCard').classList.remove('hidden');
            document.getElementById('copyBtn').classList.remove('hidden');
            
            // –ü–æ–∫–∞–∑ —ç–∫–æ–Ω–æ–º–∏–∏
            calculateAndShowSavings(data);
            
            // –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω–æ "–ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É", —Å–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å
            if (data.decision === 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É') {
                scheduleInspection(data);
            }
            
            // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É
            document.getElementById('outputCard').scrollIntoView({ behavior: 'smooth' });
            
            showAlert('–û—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω!', 'success');
        }

        function generateReportText(data, dayType, styleType) {
            // –ë–∞–∑–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            let report = `üèçÔ∏è –ú–æ—Ç–æ–ø–æ–¥–±–æ—Ä, –æ—Å–º–æ—Ç—Ä –º–æ—Ç–æ—Ü–∏–∫–ª–∞ –ø–µ—Ä–µ–¥ –ø–æ–∫—É–ø–∫–æ–π, –≤—ã–µ–∑–¥–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞, –ø–æ–¥–±–æ—Ä –ø–æ–¥ –∫–ª—é—á.\n`;
            report += `üìû –°–µ—Ä–≥–µ–π –õ–∞–Ω–¥–∏–∫ 8 950 005-05-08\n`;
            report += `üåê –°–∞–π—Ç: motopodbor.ru\n\n`;
            
            // –¢–µ–∫—Å—Ç –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏
            const dayTexts = {
                monday: `üîç –ü–û–ß–ï–ú–£ –°–¢–û–ò–¢ –û–ë–†–ê–©–ê–¢–¨–°–Ø –ö –ü–†–û–§–ï–°–°–ò–û–ù–ê–õ–£?\n\n–í –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ –æ—Å–æ–±–µ–Ω–Ω–æ –≤–∞–∂–Ω–æ –Ω–∞—á–∏–Ω–∞—Ç—å –Ω–µ–¥–µ–ª—é —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π! üöÄ\n\n`,
                tuesday: `üí° –í–¢–û–†–ù–ò–ö - –î–ï–ù–¨ –£–ú–ù–´–• –†–ï–®–ï–ù–ò–ô!\n\n–ó–Ω–∞–µ—Ç–µ –ª–∏ –≤—ã, —á—Ç–æ 70% –º–æ—Ç–æ—Ü–∏–∫–ª–æ–≤ —Å –ø—Ä–æ–±–µ–≥–æ–º –∏–º–µ—é—Ç —Å–∫—Ä—ã—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã? ü§î\n\n`,
                wednesday: `‚ö° –°–†–ï–î–ê - –í–†–ï–ú–Ø –î–ï–ô–°–¢–í–û–í–ê–¢–¨!\n\n–ù–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π—Ç–µ –º–µ—á—Ç—ã –Ω–∞ –ø–æ—Ç–æ–º! üèçÔ∏è\n\n`,
                thursday: `üéØ –ß–ï–¢–í–ï–†–ì - –î–ï–ù–¨ –¢–û–ß–ù–û–ì–û –í–´–ë–û–†–ê!\n\n–ü–æ—á–µ–º—É –º–æ—Ç–æ–ø–æ–¥–±–æ—Ä –ª—É—á—à–µ —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞? ü§∑‚Äç‚ôÇÔ∏è\n\n`,
                friday: `üöÄ –ü–Ø–¢–ù–ò–¶–ê - –ü–û–î–ì–û–¢–û–í–ö–ê –ö –í–´–•–û–î–ù–´–ú!\n\n–ì–æ—Ç–æ–≤—ã –∫ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏—è–º –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö? üèûÔ∏è\n\n`,
                saturday: `üéâ –°–£–ë–ë–û–¢–ê - –õ–£–ß–®–ò–ô –î–ï–ù–¨ –î–õ–Ø –í–´–ë–û–†–ê!\n\n–í—ã—Ö–æ–¥–Ω—ã–µ - –∏–¥–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –¥–ª—è –ø–æ–∏—Å–∫–∞ –º–µ—á—Ç—ã! üåü\n\n`,
                sunday: `üèÜ –í–û–°–ö–†–ï–°–ï–ù–¨–ï - –ü–û–î–í–û–î–ò–ú –ò–¢–û–ì–ò!\n\n–ù–∞—á–Ω–∏—Ç–µ –Ω–æ–≤—É—é –Ω–µ–¥–µ–ª—é —Å –Ω–æ–≤—ã–º –º–æ—Ç–æ—Ü–∏–∫–ª–æ–º! üÜï\n\n`,
                simple: ``
            };
            
            if (dayTexts[dayType]) {
                report += dayTexts[dayType];
            }
            
            // –°—Ç–∏–ª—å –æ—Ç—á–µ—Ç–∞
            if (styleType === 'problem_solution') {
                report += `üö® –§–û–†–ú–ê–¢ "–ü–†–û–ë–õ–ï–ú–ê/–†–ï–®–ï–ù–ò–ï"\n\n`;
                report += `–ü—Ä–æ–±–ª–µ–º–∞: –ö–ª–∏–µ–Ω—Ç —Ö–æ—á–µ—Ç –∫—É–ø–∏—Ç—å ${data.brand} ${data.model} ${data.year} –≥–æ–¥–∞, –Ω–æ –æ–ø–∞—Å–∞–µ—Ç—Å—è —Å–∫—Ä—ã—Ç—ã—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤.\n\n`;
                report += `–†–µ—à–µ–Ω–∏–µ: –ü—Ä–æ–≤–µ–ª–∏ –ø–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É –∏ –Ω–∞—à–ª–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç!\n\n`;
            } else if (styleType === 'structured') {
                report += `üìä –°–¢–†–£–ö–¢–£–†–ò–†–û–í–ê–ù–ù–´–ô –û–¢–ß–ï–¢\n\n`;
            } else if (styleType === 'story') {
                report += `üìñ –ò–°–¢–û–†–ò–Ø –ò–ó –ñ–ò–ó–ù–ò\n\n`;
                report += `–°–µ–≥–æ–¥–Ω—è –∫–æ –º–Ω–µ –æ–±—Ä–∞—Ç–∏–ª—Å—è –∫–ª–∏–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –¥–æ–ª–≥–æ –∏—Å–∫–∞–ª ${data.brand} ${data.model}.\n`;
                report += `–ü–æ—Å–ª–µ –æ—Å–º–æ—Ç—Ä–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –º—ã –Ω–∞—à–ª–∏ —ç—Ç–æ—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä ${data.year} –≥–æ–¥–∞.\n\n`;
            }
            
            // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            report += `üèçÔ∏è ${data.brand} ${data.model}\n`;
            if (data.year) report += `üìÖ –ì–æ–¥ –≤—ã–ø—É—Å–∫–∞: ${data.year}\n`;
            if (data.mileage) report += `üõ£Ô∏è –ü—Ä–æ–±–µ–≥: ${data.mileage} —Ç—ã—Å. –∫–º\n`;
            if (data.motorcycle_class) report += `üè∑Ô∏è –ö–ª–∞—Å—Å: ${data.motorcycle_class}\n`;
            if (data.legal_check) report += `üìã –Æ—Ä–∏–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ${data.legal_check}\n\n`;
            
            // –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
            report += `üîç –†–ï–ó–£–õ–¨–¢–ê–¢–´ –î–ò–ê–ì–ù–û–°–¢–ò–ö–ò:\n\n`;
            
            const ratings = {
                'üëÅÔ∏è –í–Ω–µ—à–Ω–∏–π –≤–∏–¥': data.appearance_rating,
                '‚öôÔ∏è –î–≤–∏–≥–∞—Ç–µ–ª—å/–ö–ü–ü': data.engine_rating,
                'üîå –≠–ª–µ–∫—Ç—Ä–æ–æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ': data.electronics_rating,
                'üõ†Ô∏è –ü–æ–¥–≤–µ—Å–∫–∞': data.suspension_rating
            };
            
            Object.entries(ratings).forEach(([label, rating]) => {
                if (rating) {
                    const stars = '‚òÖ'.repeat(parseInt(rating)) + '‚òÜ'.repeat(5 - parseInt(rating));
                    report += `${label}: ${stars}\n`;
                }
            });
            
            report += `\nüíº –í–´–í–û–î–´:\n`;
            
            if (data.key_finding) report += `üîë –ö–ª—é—á–µ–≤–∞—è –Ω–∞—Ö–æ–¥–∫–∞: ${data.key_finding}\n`;
            if (data.expert_verdict) report += `üë®‚Äçüíº –í–µ—Ä–¥–∏–∫—Ç —ç–∫—Å–ø–µ—Ä—Ç–∞: ${data.expert_verdict}\n`;
            if (data.decision) {
                report += `ü§î –†–µ—à–µ–Ω–∏–µ: ${data.decision}\n`;
                if (data.decision === 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É') {
                    if (data.inspection_date && data.inspection_time) {
                        const inspectionDate = new Date(data.inspection_date + 'T' + data.inspection_time);
                        report += `üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: ${inspectionDate.toLocaleString('ru-RU')}\n`;
                    }
                    if (data.inspection_address) {
                        report += `üìç –ê–¥—Ä–µ—Å: ${data.inspection_address}\n`;
                    }
                }
            }
            
            // –ü—Ä–∏–∑—ã–≤ –∫ –¥–µ–π—Å—Ç–≤–∏—é
            if (dayType !== 'simple') {
                report += `\n‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n`;
                report += `üìû –ì–æ—Ç–æ–≤—ã –Ω–∞–π—Ç–∏ —Å–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π –º–æ—Ç–æ—Ü–∏–∫–ª?\n`;
                report += `–ó–≤–æ–Ω–∏—Ç–µ: 8 950 005-05-08\n`;
                report += `–ú—ã –ø–æ–º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –≤—ã–±–æ—Ä! ‚úÖ`;
            }
            
            return report;
        }

        function calculateAndShowSavings(data) {
            const price = parseMoneyValue(data.price);
            const objectiveCost = parseMoneyValue(data.objective_cost);
            const sellerDiscount = parseMoneyValue(data.seller_discount);
            const investmentCost = parseMoneyValue(data.investment_cost);
            
            if (price && objectiveCost) {
                const savings = (objectiveCost - (price - sellerDiscount)) - investmentCost;
                
                if (savings > 0) {
                    const savingsAlert = document.getElementById('savingsAlert');
                    savingsAlert.textContent = `üíµ –û–±—â–∞—è —ç–∫–æ–Ω–æ–º–∏—è –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞: ${formatMoney(savings)}`;
                    savingsAlert.classList.remove('hidden');
                }
            }
        }

        function scheduleInspection(data) {
            const inspection = {
                id: Date.now().toString(),
                timestamp: new Date().toISOString(),
                brand: data.brand,
                model: data.model,
                year: data.year,
                inspection_date: data.inspection_date,
                inspection_time: data.inspection_time,
                inspection_address: data.inspection_address,
                customer_phone: data.customer_phone,
                seller_phone: data.seller_phone || '',
                inspection_notes: data.inspection_notes || '',
                status: 'planned',
                reminder_sent: false
            };
            
            inspectionsDatabase.push(inspection);
            localStorage.setItem('motodiag_inspections', JSON.stringify(inspectionsDatabase));
            
            // –ü–ª–∞–Ω–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            scheduleInspectionNotification(inspection);
            
            showAlert('–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞!', 'success');
            loadInspectionsList();
        }

        function scheduleInspectionNotification(inspection) {
            const inspectionDateTime = new Date(inspection.inspection_date + 'T' + inspection.inspection_time);
            const reminderTime = parseInt(document.getElementById('reminderTime').value) || 2;
            const reminderDateTime = new Date(inspectionDateTime.getTime() - (reminderTime * 60 * 60 * 1000));
            const now = new Date();
            
            // –ï—Å–ª–∏ –≤—Ä–µ–º—è –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –µ—â–µ –Ω–µ –Ω–∞—Å—Ç—É–ø–∏–ª–æ
            if (reminderDateTime > now) {
                const timeout = reminderDateTime.getTime() - now.getTime();
                
                const timeoutId = setTimeout(() => {
                    if (document.getElementById('inspectionNotifications').checked) {
                        showInspectionNotification(inspection);
                    }
                }, timeout);
                
                notificationTimeouts.push({
                    id: inspection.id,
                    timeoutId: timeoutId
                });
            }
        }

        function scheduleInspectionNotifications() {
            // –û—á–∏—â–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–π–º–µ—Ä—ã
            notificationTimeouts.forEach(item => {
                clearTimeout(item.timeoutId);
            });
            notificationTimeouts = [];
            
            // –ü–ª–∞–Ω–∏—Ä—É–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫
            inspectionsDatabase.forEach(inspection => {
                if (inspection.status === 'planned' && !inspection.reminder_sent) {
                    scheduleInspectionNotification(inspection);
                }
            });
        }

        function showInspectionNotification(inspection) {
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
            inspection.reminder_sent = true;
            localStorage.setItem('motodiag_inspections', JSON.stringify(inspectionsDatabase));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            if (Notification.permission === 'granted') {
                new Notification('üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –æ –ø—Ä–æ–≤–µ—Ä–∫–µ', {
                    body: `–ü—Ä–æ–≤–µ—Ä–∫–∞ ${inspection.brand} ${inspection.model} –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞!\n–ê–¥—Ä–µ—Å: ${inspection.inspection_address}`,
                    icon: '/icon.png',
                    tag: 'inspection-reminder'
                });
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º alert –∫–∞–∫ fallback
            showAlert(`üîî –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ: –ü—Ä–æ–≤–µ—Ä–∫–∞ ${inspection.brand} ${inspection.model} –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ 2 —á–∞—Å–∞!`, 'info');
        }

        function saveReportToDatabase() {
            if (!validateForm()) return;
            
            const formData = new FormData(document.getElementById('diagnosticForm'));
            const data = Object.fromEntries(formData.entries());
            
            const report = {
                id: Date.now().toString(),
                timestamp: new Date().toISOString(),
                ...data,
                generated_text: document.getElementById('output').textContent
            };
            
            reportsDatabase.push(report);
            localStorage.setItem('motodiag_reports', JSON.stringify(reportsDatabase));
            
            showAlert('–û—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö!', 'success');
            loadReportsList();
        }

        function loadReportsList(searchTerm = '') {
            const reportsList = document.getElementById('reportsList');
            
            if (reportsDatabase.length === 0) {
                reportsList.innerHTML = '<div class="text-center" style="padding: 20px; color: var(--text-light);">–ù–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –æ—Ç—á–µ—Ç–æ–≤</div>';
                return;
            }
            
            const filteredReports = reportsDatabase.filter(report => {
                if (!searchTerm) return true;
                
                const searchLower = searchTerm.toLowerCase();
                return (
                    report.brand?.toLowerCase().includes(searchLower) ||
                    report.model?.toLowerCase().includes(searchLower) ||
                    report.year?.includes(searchTerm)
                );
            }).reverse();
            
            if (filteredReports.length === 0) {
                reportsList.innerHTML = '<div class="text-center" style="padding: 20px; color: var(--text-light);">–û—Ç—á–µ—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            reportsList.innerHTML = filteredReports.map((report, index) => `
                <div class="report-item">
                    <div class="report-header">
                        <div class="report-title">${report.brand} ${report.model} (${report.year})</div>
                        <div class="report-actions">
                            <button class="action-btn" style="background: var(--secondary-color); color: white;" onclick="viewReport('${report.id}')">üëÅÔ∏è</button>
                            <button class="action-btn" style="background: var(--warning-color); color: white;" onclick="editReport('${report.id}')">‚úèÔ∏è</button>
                            <button class="action-btn" style="background: var(--danger-color); color: white;" onclick="deleteReport('${report.id}')">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="report-meta">
                        <div>–ü—Ä–æ–±–µ–≥: ${report.mileage || '0'} —Ç—ã—Å.–∫–º</div>
                        <div>–¶–µ–Ω–∞: ${report.price || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}</div>
                        <div>–ö–ª–∞—Å—Å: ${report.motorcycle_class || '–ù–µ —É–∫–∞–∑–∞–Ω'}</div>
                        <div>–†–µ—à–µ–Ω–∏–µ: ${report.decision || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</div>
                    </div>
                </div>
            `).join('');
        }

        function loadInspectionsList(searchTerm = '') {
            const inspectionsList = document.getElementById('inspectionsList');
            
            if (inspectionsDatabase.length === 0) {
                inspectionsList.innerHTML = '<div class="text-center" style="padding: 20px; color: var(--text-light);">–ù–µ—Ç –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫</div>';
                return;
            }
            
            const filteredInspections = inspectionsDatabase.filter(inspection => {
                if (!searchTerm) return true;
                
                const searchLower = searchTerm.toLowerCase();
                return (
                    inspection.brand?.toLowerCase().includes(searchLower) ||
                    inspection.model?.toLowerCase().includes(searchLower) ||
                    inspection.inspection_address?.toLowerCase().includes(searchLower)
                );
            }).sort((a, b) => new Date(a.inspection_date + 'T' + a.inspection_time) - new Date(b.inspection_date + 'T' + b.inspection_time));
            
            if (filteredInspections.length === 0) {
                inspectionsList.innerHTML = '<div class="text-center" style="padding: 20px; color: var(--text-light);">–ü—Ä–æ–≤–µ—Ä–∫–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            inspectionsList.innerHTML = filteredInspections.map((inspection, index) => {
                const inspectionDateTime = new Date(inspection.inspection_date + 'T' + inspection.inspection_time);
                const now = new Date();
                const timeDiff = inspectionDateTime.getTime() - now.getTime();
                const hoursDiff = timeDiff / (1000 * 60 * 60);
                
                const isUrgent = hoursDiff < 24 && hoursDiff > 0;
                const isOverdue = timeDiff < 0 && inspection.status === 'planned';
                
                let statusBadge = '';
                if (inspection.status === 'completed') {
                    statusBadge = '<span class="badge badge-success">‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ</span>';
                } else if (isOverdue) {
                    statusBadge = '<span class="badge badge-warning">‚ö†Ô∏è –ü—Ä–æ—Å—Ä–æ—á–µ–Ω–æ</span>';
                } else if (isUrgent) {
                    statusBadge = '<span class="badge badge-warning">üîî –°—Ä–æ—á–Ω–æ</span>';
                } else {
                    statusBadge = '<span class="badge badge-info">üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ</span>';
                }
                
                return `
                <div class="inspection-item ${isUrgent ? 'urgent' : ''} ${inspection.status === 'completed' ? 'completed' : ''}">
                    <div class="inspection-header">
                        <div class="inspection-title">${inspection.brand} ${inspection.model} (${inspection.year})</div>
                        <div class="inspection-date">${inspectionDateTime.toLocaleDateString('ru-RU')} ${inspection.inspection_time}</div>
                    </div>
                    <div class="inspection-details">
                        <div><strong>–ê–¥—Ä–µ—Å:</strong> ${inspection.inspection_address}</div>
                        <div><strong>–ó–∞–∫–∞–∑—á–∏–∫:</strong> ${inspection.customer_phone}</div>
                        <div><strong>–ü—Ä–æ–¥–∞–≤–µ—Ü:</strong> ${inspection.seller_phone || '–ù–µ —É–∫–∞–∑–∞–Ω'}</div>
                        <div><strong>–°—Ç–∞—Ç—É—Å:</strong> ${statusBadge}</div>
                    </div>
                    ${inspection.inspection_notes ? `<div style="margin-bottom: 12px;"><strong>–ó–∞–º–µ—Ç–∫–∏:</strong> ${inspection.inspection_notes}</div>` : ''}
                    <div class="inspection-actions">
                        <button class="action-btn" style="background: var(--secondary-color); color: white;" onclick="viewInspection('${inspection.id}')">üëÅÔ∏è</button>
                        <button class="action-btn" style="background: var(--success-color); color: white;" onclick="completeInspection('${inspection.id}')">‚úÖ</button>
                        <button class="action-btn" style="background: var(--warning-color); color: white;" onclick="editInspection('${inspection.id}')">‚úèÔ∏è</button>
                        <button class="action-btn" style="background: var(--danger-color); color: white;" onclick="deleteInspection('${inspection.id}')">üóëÔ∏è</button>
                    </div>
                </div>
                `;
            }).join('');
        }

        function viewReport(reportId) {
            const report = reportsDatabase.find(r => r.id === reportId);
            if (!report) return;
            
            document.getElementById('output').textContent = report.generated_text;
            document.getElementById('outputCard').classList.remove('hidden');
            document.getElementById('copyBtn').classList.remove('hidden');
            document.querySelector('.nav-tab[data-tab="report"]').click();
            document.getElementById('outputCard').scrollIntoView({ behavior: 'smooth' });
        }

        function viewInspection(inspectionId) {
            const inspection = inspectionsDatabase.find(i => i.id === inspectionId);
            if (!inspection) return;
            
            const inspectionDateTime = new Date(inspection.inspection_date + 'T' + inspection.inspection_time);
            const inspectionDetails = `
üèçÔ∏è –î–µ—Ç–∞–ª–∏ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:

–ú–æ—Ç–æ—Ü–∏–∫–ª: ${inspection.brand} ${inspection.model} (${inspection.year})
üìÖ –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è: ${inspectionDateTime.toLocaleString('ru-RU')}
üìç –ê–¥—Ä–µ—Å: ${inspection.inspection_address}
üìû –¢–µ–ª–µ—Ñ–æ–Ω –∑–∞–∫–∞–∑—á–∏–∫–∞: ${inspection.customer_phone}
üìû –¢–µ–ª–µ—Ñ–æ–Ω –ø—Ä–æ–¥–∞–≤—Ü–∞: ${inspection.seller_phone || '–ù–µ —É–∫–∞–∑–∞–Ω'}
${inspection.inspection_notes ? `üìù –ó–∞–º–µ—Ç–∫–∏: ${inspection.inspection_notes}` : ''}
üìä –°—Ç–∞—Ç—É—Å: ${inspection.status === 'completed' ? '‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ' : 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ'}

–î–ª—è —Å–≤—è–∑–∏: 8 950 005-05-08
            `;
            
            document.getElementById('output').textContent = inspectionDetails;
            document.getElementById('outputCard').classList.remove('hidden');
            document.getElementById('copyBtn').classList.remove('hidden');
            document.querySelector('.nav-tab[data-tab="report"]').click();
            document.getElementById('outputCard').scrollIntoView({ behavior: 'smooth' });
        }

        function completeInspection(inspectionId) {
            const inspection = inspectionsDatabase.find(i => i.id === inspectionId);
            if (!inspection) return;
            
            inspection.status = 'completed';
            localStorage.setItem('motodiag_inspections', JSON.stringify(inspectionsDatabase));
            loadInspectionsList();
            showAlert('–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–º–µ—á–µ–Ω–∞ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–∞—è!', 'success');
        }

        function editInspection(inspectionId) {
            const inspection = inspectionsDatabase.find(i => i.id === inspectionId);
            if (!inspection) return;
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
            document.getElementById('brand').value = inspection.brand;
            document.getElementById('model').value = inspection.model;
            document.getElementById('year').value = inspection.year;
            document.getElementById('decision').value = 'üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É';
            document.getElementById('inspection_date').value = inspection.inspection_date;
            document.getElementById('inspection_time').value = inspection.inspection_time;
            document.getElementById('inspection_address').value = inspection.inspection_address;
            document.getElementById('customer_phone').value = inspection.customer_phone;
            document.getElementById('seller_phone').value = inspection.seller_phone;
            document.getElementById('inspection_notes').value = inspection.inspection_notes || '';
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
            document.getElementById('inspectionFields').classList.remove('hidden');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–¥–µ–ª–∏
            updateModelOptions(inspection.brand);
            
            // –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—É—é –ø—Ä–æ–≤–µ—Ä–∫—É
            deleteInspection(inspectionId, false);
            
            document.querySelector('.nav-tab[data-tab="report"]').click();
            showAlert('–î–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ —Ñ–æ—Ä–º—É –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'info');
        }

        function deleteInspection(inspectionId, showAlert = true) {
            if (!showAlert || confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –ø—Ä–æ–≤–µ—Ä–∫—É?')) {
                inspectionsDatabase = inspectionsDatabase.filter(i => i.id !== inspectionId);
                localStorage.setItem('motodiag_inspections', JSON.stringify(inspectionsDatabase));
                loadInspectionsList();
                if (showAlert) {
                    showAlert('–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω–∞', 'success');
                }
            }
        }

        function editReport(reportId) {
            const report = reportsDatabase.find(r => r.id === reportId);
            if (!report) return;
            
            // –ó–∞–ø–æ–ª–Ω—è–µ–º —Ñ–æ—Ä–º—É
            Object.keys(report).forEach(key => {
                const element = document.getElementById(key);
                if (element && report[key]) {
                    element.value = report[key];
                }
            });
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –º–æ–¥–µ–ª–∏
            if (report.brand) {
                updateModelOptions(report.brand);
            }
            
            document.querySelector('.nav-tab[data-tab="report"]').click();
            showAlert('–î–∞–Ω–Ω—ã–µ –æ—Ç—á–µ—Ç–∞ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ —Ñ–æ—Ä–º—É –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è', 'info');
        }

        function deleteReport(reportId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç?')) {
                reportsDatabase = reportsDatabase.filter(r => r.id !== reportId);
                localStorage.setItem('motodiag_reports', JSON.stringify(reportsDatabase));
                loadReportsList();
                showAlert('–û—Ç—á–µ—Ç —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω', 'success');
            }
        }

        function updateStatistics(period = 'week') {
            const now = new Date();
            let startDate;
            
            switch(period) {
                case 'week': startDate = new Date(now - 7 * 24 * 60 * 60 * 1000); break;
                case 'month': startDate = new Date(now.getFullYear(), now.getMonth(), 1); break;
                case 'quarter': 
                    const quarter = Math.floor(now.getMonth() / 3);
                    startDate = new Date(now.getFullYear(), quarter * 3, 1);
                    break;
                case 'year': startDate = new Date(now.getFullYear(), 0, 1); break;
            }
            
            const periodReports = reportsDatabase.filter(report => 
                new Date(report.timestamp) >= startDate
            );
            
            const totalReports = periodReports.length;
            const purchased = periodReports.filter(r => r.decision === '‚úÖ –ö—É–ø–ª–µ–Ω').length;
            
            // –†–∞—Å—á–µ—Ç —ç–∫–æ–Ω–æ–º–∏–∏
            let totalSavings = 0;
            periodReports.forEach(report => {
                const price = parseMoneyValue(report.price);
                const objectiveCost = parseMoneyValue(report.objective_cost);
                const sellerDiscount = parseMoneyValue(report.seller_discount);
                const investmentCost = parseMoneyValue(report.investment_cost);
                
                if (price && objectiveCost) {
                    const savings = (objectiveCost - (price - sellerDiscount)) - investmentCost;
                    if (savings > 0) totalSavings += savings;
                }
            });
            
            const avgSavings = purchased > 0 ? totalSavings / purchased : 0;
            
            // –ü–æ–ø—É–ª—è—Ä–Ω–∞—è –º–∞—Ä–∫–∞
            const brandCounts = {};
            periodReports.forEach(report => {
                if (report.brand) {
                    brandCounts[report.brand] = (brandCounts[report.brand] || 0) + 1;
                }
            });
            
            const popularBrand = Object.keys(brandCounts).reduce((a, b) => 
                brandCounts[a] > brandCounts[b] ? a : b, '–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö'
            );
            
            // –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –ø—Ä–æ–≤–µ—Ä–∫–∞–º
            const plannedInspections = inspectionsDatabase.filter(i => i.status === 'planned').length;
            const completedInspections = inspectionsDatabase.filter(i => i.status === 'completed').length;
            
            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI
            document.getElementById('totalReports').textContent = totalReports;
            document.getElementById('successfulDeals').textContent = purchased;
            document.getElementById('avgSavings').textContent = formatMoney(avgSavings);
            document.getElementById('popularBrand').textContent = popularBrand;
            document.getElementById('plannedInspections').textContent = plannedInspections;
            document.getElementById('completedInspections').textContent = completedInspections;
        }

        function generateStatsPost() {
            const totalReports = reportsDatabase.length;
            const purchased = reportsDatabase.filter(r => r.decision === '‚úÖ –ö—É–ø–ª–µ–Ω').length;
            const successRate = totalReports > 0 ? Math.round((purchased / totalReports) * 100) : 0;
            
            let totalSavings = 0;
            reportsDatabase.forEach(report => {
                const price = parseMoneyValue(report.price);
                const objectiveCost = parseMoneyValue(report.objective_cost);
                const sellerDiscount = parseMoneyValue(report.seller_discount);
                const investmentCost = parseMoneyValue(report.investment_cost);
                
                if (price && objectiveCost) {
                    const savings = (objectiveCost - (price - sellerDiscount)) - investmentCost;
                    if (savings > 0) totalSavings += savings;
                }
            });
            
            const statsPost = `
üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê –ú–û–¢–û–ü–û–î–ë–û–†–ê

–ó–∞ –≤—Å–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:

üèçÔ∏è –ü—Ä–æ—Å–º–æ—Ç—Ä–µ–Ω–æ –º–æ—Ç–æ—Ü–∏–∫–ª–æ–≤: ${totalReports}
‚úÖ –£—Å–ø–µ—à–Ω—ã—Ö —Å–¥–µ–ª–æ–∫: ${purchased}
üìà –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞: ${successRate}%
üíµ –û–±—â–∞—è —ç–∫–æ–Ω–æ–º–∏—è –∫–ª–∏–µ–Ω—Ç–æ–≤: ${formatMoney(totalSavings)}
üìÖ –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ –ø—Ä–æ–≤–µ—Ä–æ–∫: ${inspectionsDatabase.filter(i => i.status === 'planned').length}
‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ –ø—Ä–æ–≤–µ—Ä–æ–∫: ${inspectionsDatabase.filter(i => i.status === 'completed').length}

üîß –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ = —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –≤ –ø–æ–∫—É–ø–∫–µ!
üìû –ó–≤–æ–Ω–∏—Ç–µ: 8 950 005-05-08
üåê –°–∞–π—Ç: motopodbor.ru
            `;
            
            document.getElementById('statsOutput').textContent = statsPost;
            document.getElementById('statsOutput').classList.remove('hidden');
            document.getElementById('copyStatsBtn').classList.remove('hidden');
            document.getElementById('statsOutput').scrollIntoView({ behavior: 'smooth' });
        }

        function exportDatabase() {
            const dataStr = JSON.stringify(reportsDatabase, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `motodiag_reports_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showAlert('–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞', 'success');
        }

        function exportInspections() {
            const dataStr = JSON.stringify(inspectionsDatabase, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `motodiag_inspections_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showAlert('–ü—Ä–æ–≤–µ—Ä–∫–∏ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        }

        function importDatabase() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = event => {
                    try {
                        const importedData = JSON.parse(event.target.result);
                        
                        if (confirm(`–ù–∞–π–¥–µ–Ω–æ ${importedData.length} –æ—Ç—á–µ—Ç–æ–≤. –î–æ–±–∞–≤–∏—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º?`)) {
                            reportsDatabase = [...reportsDatabase, ...importedData];
                            localStorage.setItem('motodiag_reports', JSON.stringify(reportsDatabase));
                            loadReportsList();
                            updateStatistics();
                            showAlert(`–£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${importedData.length} –æ—Ç—á–µ—Ç–æ–≤`, 'success');
                        }
                    } catch (error) {
                        showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞', 'warning');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }

        function importInspections() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = event => {
                    try {
                        const importedData = JSON.parse(event.target.result);
                        
                        if (confirm(`–ù–∞–π–¥–µ–Ω–æ ${importedData.length} –ø—Ä–æ–≤–µ—Ä–æ–∫. –î–æ–±–∞–≤–∏—Ç—å –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º?`)) {
                            inspectionsDatabase = [...inspectionsDatabase, ...importedData];
                            localStorage.setItem('motodiag_inspections', JSON.stringify(inspectionsDatabase));
                            loadInspectionsList();
                            updateStatistics();
                            scheduleInspectionNotifications();
                            showAlert(`–£—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${importedData.length} –ø—Ä–æ–≤–µ—Ä–æ–∫`, 'success');
                        }
                    } catch (error) {
                        showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞', 'warning');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }

        function toggleTheme() {
            const isDark = document.getElementById('darkTheme').checked;
            const theme = isDark ? 'dark' : 'light';
            document.body.setAttribute('data-theme', theme);
            localStorage.setItem('motodiag_theme', theme);
        }

        function toggleThemeManual() {
            const isDark = document.body.getAttribute('data-theme') === 'dark';
            const newTheme = isDark ? 'light' : 'dark';
            document.body.setAttribute('data-theme', newTheme);
            document.getElementById('darkTheme').checked = !isDark;
            localStorage.setItem('motodiag_theme', newTheme);
        }

        function exportSettings() {
            const settings = {
                theme: localStorage.getItem('motodiag_theme'),
                formData: localStorage.getItem('motodiag_form_data'),
                autoSave: document.getElementById('autoSave').checked,
                soundNotifications: document.getElementById('soundNotifications').checked,
                vibration: document.getElementById('vibration').checked,
                inspectionNotifications: document.getElementById('inspectionNotifications').checked,
                reminderTime: document.getElementById('reminderTime').value
            };
            
            const dataStr = JSON.stringify(settings, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `motodiag_settings_${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
        }

        function importSettings() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            
            input.onchange = e => {
                const file = e.target.files[0];
                const reader = new FileReader();
                
                reader.onload = event => {
                    try {
                        const importedSettings = JSON.parse(event.target.result);
                        
                        if (confirm('–ó–∞–º–µ–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏?')) {
                            if (importedSettings.theme) {
                                document.body.setAttribute('data-theme', importedSettings.theme);
                                document.getElementById('darkTheme').checked = importedSettings.theme === 'dark';
                                localStorage.setItem('motodiag_theme', importedSettings.theme);
                            }
                            
                            if (importedSettings.formData) {
                                localStorage.setItem('motodiag_form_data', importedSettings.formData);
                                loadFormData();
                            }
                            
                            if (importedSettings.autoSave !== undefined) {
                                document.getElementById('autoSave').checked = importedSettings.autoSave;
                            }
                            
                            if (importedSettings.soundNotifications !== undefined) {
                                document.getElementById('soundNotifications').checked = importedSettings.soundNotifications;
                            }
                            
                            if (importedSettings.vibration !== undefined) {
                                document.getElementById('vibration').checked = importedSettings.vibration;
                            }
                            
                            if (importedSettings.inspectionNotifications !== undefined) {
                                document.getElementById('inspectionNotifications').checked = importedSettings.inspectionNotifications;
                            }
                            
                            if (importedSettings.reminderTime !== undefined) {
                                document.getElementById('reminderTime').value = importedSettings.reminderTime;
                                localStorage.setItem('motodiag_reminder_time', importedSettings.reminderTime);
                            }
                            
                            showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É—Å–ø–µ—à–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã', 'success');
                        }
                    } catch (error) {
                        showAlert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ —Ñ–∞–π–ª–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫', 'warning');
                    }
                };
                
                reader.readAsText(file);
            };
            
            input.click();
        }

        function clearAllData() {
            if (confirm('–í–ù–ò–ú–ê–ù–ò–ï! –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ —É–¥–∞–ª–∏—Ç –≤—Å–µ –æ—Ç—á–µ—Ç—ã, –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏. –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å?')) {
                localStorage.clear();
                reportsDatabase = [];
                inspectionsDatabase = [];
                loadReportsList();
                loadInspectionsList();
                clearForm();
                showAlert('–í—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ—á–∏—â–µ–Ω—ã', 'success');
            }
        }

        // PWA —Ñ—É–Ω–∫—Ü–∏–∏
        function checkPWAInstall() {
            window.addEventListener('beforeinstallprompt', (e) => {
                e.preventDefault();
                deferredPrompt = e;
                document.getElementById('installBtn').style.display = 'block';
            });
        }

        function installPWA() {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                deferredPrompt.userChoice.then((choiceResult) => {
                    if (choiceResult.outcome === 'accepted') {
                        showAlert('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ!', 'success');
                        document.getElementById('installBtn').style.display = 'none';
                    }
                    deferredPrompt = null;
                });
            }
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function parseMoneyValue(value) {
            if (!value) return 0;
            const clean = value.toString().replace(/\s/g, '').replace(',', '.');
            return parseFloat(clean) || 0;
        }

        function formatMoney(amount) {
            return new Intl.NumberFormat('ru-RU', {
                style: 'currency',
                currency: 'RUB',
                minimumFractionDigits: 0
            }).format(amount);
        }

        function showAlert(message, type) {
            const alert = document.getElementById(`${type}Alert`);
            alert.textContent = message;
            alert.classList.remove('hidden');
            
            setTimeout(() => {
                alert.classList.add('hidden');
            }, 5000);
        }

        function copyToClipboard() {
            const text = document.getElementById('output').textContent;
            navigator.clipboard.writeText(text).then(() => {
                showAlert('–û—Ç—á–µ—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            });
        }

        function copyStatsToClipboard() {
            const text = document.getElementById('statsOutput').textContent;
            navigator.clipboard.writeText(text).then(() => {
                showAlert('–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!', 'success');
            });
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è HTML
        window.viewReport = viewReport;
        window.viewInspection = viewInspection;
        window.editReport = editReport;
        window.editInspection = editInspection;
        window.deleteReport = deleteReport;
        window.deleteInspection = deleteInspection;
        window.completeInspection = completeInspection;

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –¥–∞—Ç—ã –≤–µ—Ä—Å–∏–∏
        document.getElementById('appVersionDate').textContent = new Date().getFullYear();

        // –ó–∞–ø—Ä–æ—Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        if ('Notification' in window && Notification.permission === 'default') {
            Notification.requestPermission();
        }

        // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
        document.getElementById('reminderTime').addEventListener('change', function() {
            localStorage.setItem('motodiag_reminder_time', this.value);
            scheduleInspectionNotifications();
        });
    </script>
</body>
</html>